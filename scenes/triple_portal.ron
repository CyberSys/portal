(desc:(eng:"# Triple portal\n\nWe used to that portal constists only of two parts: blue and orange, and both are equal, both are works like input and output. But what if we want to create portal with tree equal parts? Is that even possible? Yes! And you can see the result in this scene.\n\nNothing tears up through this portal (light and polygons too). It looks continuous. But actually, objects is cutted in the middle of this portal, but this cut is compensated on the other side by two more portals. This is how portals work: on other side immedeately restores destroyed object on current side.\n\n# Color\n\nBlue and orange painting is classic for portals, but for this triple portal I think Red, Green and Blue colors are suitable.\n\n# Twitter\n\n<https://twitter.com/optozorax/status/1373077780720668675>",rus:"# Тройной портал\n\nМы привыкли что порталы состоят только из двух частей: голубая и оранжевая, и обе равноценны, обе работают как вход и выход. Но что если мы хотим создать портал с тремя равными частями? Такое вообще возможно? Да! И в этой сцене вы можете увидеть результат.\n\nКак видно, он ничего не рвёт, выглядит очень непрерывно, и вообще, даже объект в центре него получается целым! На самом деле, в стыке, где соединяются три портала, объект разрезается, но потом это разрезание тут же компенсируется, благодаря чему объект остаётся целым как бы он не входил. Так работают любые порталы: моментально уничтожая объект в одном месте и собирая в другом, тут просто этого происходит сложнее.\n\n# Раскраска\n\nГолубой и оранжевый — классические цвета для двух порталов, а для трёх порталов, мне кажется, подходят Красный, Зелёный и Синий (RGB).\n\n# Twitter\n\n<https://twitter.com/optozorax/status/1373077780720668675>"),cam:(look_at:(0,0,0),alpha:2.050142483241368,beta:1.090175724029541,r:3.4980000000000047,offset_after_material:0.000025),uniforms:(ids:(available:[(40),(41)],max:43),storage:{(0):Named(Float((min:Some(0),max:None,value:4)),"room_size_x"),(1):Named(Float((min:Some(0),max:None,value:4)),"room_size_y"),(2):Named(Float((min:Some(0),max:None,value:4)),"room_size_z"),(3):Inline(Formula(("-room_size_x"))),(4):Inline(Formula(("-room_size_y"))),(5):Inline(Formula(("-room_size_z"))),(6):Named(Bool(true),"teleport_light"),(7):Named(Float((min:None,max:None,value:0.64)),"height"),(8):Named(Float((min:None,max:None,value:1.56)),"width"),(9):Named(Float((min:None,max:None,value:0.13)),"border"),(10):Named(Progress(0),"side_border"),(11):Named(Float((min:None,max:None,value:0.01)),"black_border"),(12):Named(Progress(1),"polygon_size"),(13):Named(Progress(1),"color_progress"),(14):Named(Progress(0),"progress"),(15):Inline(Formula(("progress"))),(16):Inline(Formula(("0.001 + progress * 0.5"))),(17):Inline(Formula(("3/4*0.5*1.154*(1.0-progress)"))),(18):Inline(Formula(("-(3.0^0.5)/4*0.5*1.154*(1.0-progress)"))),(19):Inline(Formula(("-3/4*0.5*1.154*(1.0-progress)"))),(20):Inline(Formula(("-(3.0^0.5)/4*0.5*1.154*(1.0-progress)"))),(21):Inline(Formula(("(1.0 - progress) * border"))),(22):Inline(Formula(("progress"))),(23):Inline(Float((min:None,max:None,value:0))),(24):Inline(Float((min:None,max:None,value:0))),(25):Inline(Formula(("2.0 - progress * 2"))),(26):Inline(Formula(("min(progress, 0.3) / 0.3"))),(27):Inline(Float((min:None,max:None,value:0))),(28):Inline(Float((min:None,max:None,value:0))),(29):Inline(Float((min:None,max:None,value:0))),(30):Named(Bool(false),"two_sided"),(31):Named(Bool(false),"gray_room"),(32):Named(Float((min:None,max:None,value:1.17)),"aa"),(33):Named(Float((min:None,max:None,value:3)),"ab"),(34):Inline(Float((min:None,max:None,value:0))),(35):Named(Formula(("t1%180")),"t2"),(36):Inline(Formula(("(cos((t2+30)/180*pi()*2)+1)/2*(ab-aa)+aa"))),(37):Inline(Formula(("deg2rad(t1)"))),(38):Named(Formula(("((time*speed)*180)%360")),"t1"),(39):Named(Float((min:None,max:None,value:0.25)),"speed"),(42):Inline(Formula(("")))},storage_order:[(0),(1),(2),(6),(7),(8),(9),(10),(11),(12),(13),(14),(30),(31),(32),(33),(39),(38),(35)]),matrices:(ids:(available:[],max:75),storage:{(0):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"room_origin"),(1):Inline(Mul(to:Some(((2))),what:Some(((0))))),(2):Inline(Parametrized(offset:(x:Yes(Some(((0)))),y:No(0),z:No(0)),rotate:(x:No(0),y:No(1.5707963267948966),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(3):Inline(Mul(to:Some(((4))),what:Some(((0))))),(4):Inline(Parametrized(offset:(x:Yes(Some(((3)))),y:No(0),z:No(0)),rotate:(x:No(0),y:No(1.5707963267948966),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(5):Inline(Mul(to:Some(((6))),what:Some(((0))))),(6):Inline(Parametrized(offset:(x:No(0),y:Yes(Some(((1)))),z:No(0)),rotate:(x:No(1.5707963267948966),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(7):Inline(Mul(to:Some(((8))),what:Some(((0))))),(8):Inline(Parametrized(offset:(x:No(0),y:Yes(Some(((4)))),z:No(0)),rotate:(x:No(1.5707963267948966),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(9):Inline(Mul(to:Some(((10))),what:Some(((0))))),(10):Inline(Parametrized(offset:(x:No(0),y:No(0),z:Yes(Some(((2))))),rotate:(x:No(0),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(11):Inline(Mul(to:Some(((12))),what:Some(((0))))),(12):Inline(Parametrized(offset:(x:No(0),y:No(0),z:Yes(Some(((5))))),rotate:(x:No(0),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(13):Named(Simple(offset:(0,0,0.5),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"symmetric_offset"),(14):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"r"),(15):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,2.0943951023931953,0),mirror:(false,false,false)),"g"),(16):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,4.1887902047863905,0),mirror:(false,false,false)),"b"),(17):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,5.759586531581287,0),mirror:(false,false,false)),"first"),(18):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,3.6651914291880923,0),mirror:(false,false,false)),"second"),(19):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"r_user"),(20):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"g_user"),(21):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"b_user"),(22):Inline(Mul(to:Some(((18))),what:Some(((41))))),(23):Named(Simple(offset:(-0.08,0,3.7),scale:1,rotate:(4.71238898038469,0,0),mirror:(false,false,false)),"polygon"),(24):Named(Teleport(first_portal:Some(((27))),second_portal:Some(((29))),what:Some(((23)))),"polygon_g"),(25):Inline(Mul(to:Some(((17))),what:Some(((40))))),(26):Named(Teleport(first_portal:Some(((30))),second_portal:Some(((32))),what:Some(((23)))),"polygon_b"),(27):Inline(Mul(to:Some(((17))),what:Some(((40))))),(28):Inline(Mul(to:Some(((18))),what:Some(((42))))),(29):Inline(Mul(to:Some(((18))),what:Some(((41))))),(30):Inline(Mul(to:Some(((18))),what:Some(((40))))),(31):Inline(Mul(to:Some(((17))),what:Some(((41))))),(32):Inline(Mul(to:Some(((17))),what:Some(((42))))),(33):Named(Simple(offset:(9,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"room_r"),(34):Inline(Mul(to:Some(((18))),what:Some(((40))))),(35):Named(Simple(offset:(0,9,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"room_g"),(36):Named(Simple(offset:(0,0,9),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"room_b"),(37):Inline(Mul(to:Some(((17))),what:Some(((42))))),(38):Inline(Parametrized(offset:(x:No(0),y:No(0),z:Yes(Some(((16))))),rotate:(x:No(0),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(39):Inline(Parametrized(offset:(x:Yes(Some(((17)))),y:No(0),z:Yes(Some(((18))))),rotate:(x:No(0),y:No(5.759586531581287),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(40):Named(Mul(to:Some(((43))),what:Some(((14)))),"portal_r"),(41):Named(Mul(to:Some(((44))),what:Some(((15)))),"portal_g"),(42):Named(Mul(to:Some(((45))),what:Some(((16)))),"portal_b"),(43):Inline(Mul(to:Some(((19))),what:Some(((13))))),(44):Inline(Mul(to:Some(((20))),what:Some(((13))))),(45):Inline(Mul(to:Some(((21))),what:Some(((13))))),(46):Inline(Parametrized(offset:(x:Yes(Some(((19)))),y:No(0),z:Yes(Some(((20))))),rotate:(x:No(0),y:No(3.6651914291880923),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(47):Inline(Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false))),(48):Inline(Mul(to:Some(((51))),what:Some(((33))))),(49):Inline(Mul(to:Some(((52))),what:Some(((35))))),(50):Inline(Mul(to:Some(((53))),what:Some(((36))))),(51):Inline(Mul(to:Some(((19))),what:Some(((14))))),(52):Inline(Mul(to:Some(((20))),what:Some(((15))))),(53):Inline(Mul(to:Some(((21))),what:Some(((16))))),(54):Inline(Parametrized(offset:(x:No(0),y:No(0),z:Yes(Some(((25))))),rotate:(x:No(4.71238898038469),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(55):Inline(Simple(offset:(0,0,2),scale:1,rotate:(4.71238898038469,0,0),mirror:(false,false,false))),(56):Inline(Simple(offset:(0,0,1.28),scale:1,rotate:(0,3.141592653589793,1.5707963267948966),mirror:(false,false,false))),(57):Inline(Simple(offset:(0,0,0.85),scale:1,rotate:(0,3.141592653589793,1.5707963267948966),mirror:(false,false,false))),(58):Inline(Simple(offset:(0,0,1.77),scale:1,rotate:(0,3.141592653589793,2.8623399732707004),mirror:(false,false,false))),(59):Inline(Simple(offset:(0,0,1.56),scale:1,rotate:(0,3.141592653589793,0),mirror:(false,false,false))),(60):Inline(Simple(offset:(0,-0.76,0),scale:1,rotate:(4.71238898038469,0,0),mirror:(false,false,false))),(61):Inline(Mul(to:Some(((18))),what:Some(((40))))),(62):Inline(Mul(to:Some(((63))),what:Some(((42))))),(63):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,1.5707963267948966,0),mirror:(false,false,false)),"third"),(64):Inline(Mul(to:Some(((18))),what:Some(((41))))),(65):Inline(Mul(to:Some(((63))),what:Some(((40))))),(66):Inline(Mul(to:Some(((18))),what:Some(((42))))),(67):Inline(Mul(to:Some(((63))),what:Some(((41))))),(68):Inline(Mul(to:Some(((63))),what:Some(((41))))),(69):Inline(Mul(to:Some(((17))),what:Some(((40))))),(70):Inline(Mul(to:Some(((63))),what:Some(((40))))),(71):Inline(Mul(to:Some(((17))),what:Some(((42))))),(72):Inline(Mul(to:Some(((63))),what:Some(((42))))),(73):Inline(Mul(to:Some(((17))),what:Some(((41))))),(74):Inline(Parametrized(offset:(x:No(0),y:No(0),z:Yes(Some(((36))))),rotate:(x:No(0.19198621771937624),y:No(3.141592653589793),z:Yes(Some(((37))))),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1)))},storage_order:[(0),(13),(14),(15),(16),(17),(18),(63),(19),(20),(21),(40),(41),(42),(23),(24),(26),(33),(35),(36)]),objects:(ids:(available:[],max:21),storage:{(0):Named(Flat(kind:Simple(Some(((1)))),is_inside:(("if (gray_room_u == 1) {\r\nreturn is_inside_square(x, y, room_size_z_u, room_size_y_u, room_white2_M);\r\n}\n\nreturn is_inside_square(x, y, room_size_z_u, room_size_y_u, room_yellow_M);"))),"room_x+"),(1):Named(Flat(kind:Simple(Some(((3)))),is_inside:(("if (gray_room_u == 1) {\r\nreturn is_inside_square(x, y, room_size_z_u, room_size_y_u, room_white2_M);\r\n}\n\nreturn is_inside_square(x, y, room_size_z_u, room_size_y_u, room_red_M);"))),"room_x-"),(2):Named(Flat(kind:Simple(Some(((5)))),is_inside:(("if (gray_room_u == 1) {\r\nreturn is_inside_square(x, y, room_size_z_u, room_size_y_u, room_black2_M);\r\n}\n\nreturn is_inside_square(x, y, room_size_x_u, room_size_z_u, room_black_M);"))),"room_y+"),(3):Named(Flat(kind:Simple(Some(((7)))),is_inside:(("if (gray_room_u == 1) {\r\nreturn is_inside_square(x, y, room_size_z_u, room_size_y_u, room_black2_M);\r\n}\n\nreturn is_inside_square(x, y, room_size_x_u, room_size_z_u, room_gray_M);"))),"room_y-"),(4):Named(Flat(kind:Simple(Some(((9)))),is_inside:(("if (gray_room_u == 1) {\r\nreturn is_inside_square(x, y, room_size_z_u, room_size_y_u, room_white2_M);\r\n}\n\nreturn is_inside_square(x, y, room_size_x_u, room_size_y_u, room_blue_M);"))),"room_z+"),(5):Named(Flat(kind:Simple(Some(((11)))),is_inside:(("if (gray_room_u == 1) {\r\nreturn is_inside_square(x, y, room_size_z_u, room_size_y_u, room_white2_M);\r\n}\n\nreturn is_inside_square(x, y, room_size_x_u, room_size_y_u, room_green_M);"))),"room_z-"),(6):Named(Flat(kind:Portal(Some(((22))),Some(((25)))),is_inside:(("if (two_sided_u == 1 && !back) return NOT_INSIDE;\n\nreturn portal_is_inside(x, y, !back, first, solid_red_M, solid_green_M);"))),"Portal A"),(7):Named(Flat(kind:Portal(Some(((28))),Some(((31)))),is_inside:(("if (two_sided_u == 1 && !back) return NOT_INSIDE;\n\nreturn portal_is_inside(x, y, !back, first, solid_green_M, solid_blue_M);"))),"Portal B"),(8):Named(Flat(kind:Portal(Some(((34))),Some(((37)))),is_inside:(("if (two_sided_u == 1 && !back) return NOT_INSIDE;\n\nreturn portal_is_inside(x, y, !back, first, solid_blue_M, solid_red_M);"))),"Portal C"),(9):Named(Flat(kind:Simple(Some(((23)))),is_inside:(("vec4 pos1 = portal_r_mat_inv * pos;\nif (pos1.z < abs(pos1.x)/sqrt(3.0)) return NOT_INSIDE;\n\nreturn is_inside_polygon(x, y);"))),"polygon r"),(10):Named(Flat(kind:Simple(Some(((24)))),is_inside:(("vec4 pos1 = portal_g_mat_inv * pos;\nif (pos1.z < abs(pos1.x)/sqrt(3.0)) return NOT_INSIDE;\n\nreturn is_inside_polygon(x, y);"))),"polygon_g"),(11):Named(Flat(kind:Simple(Some(((26)))),is_inside:(("vec4 pos1 = portal_b_mat_inv * pos;\nif (pos1.z < abs(pos1.x)/sqrt(3.0)) return NOT_INSIDE;\n\nreturn is_inside_polygon(x, y);"))),"polygon_b"),(12):Named(Complex(kind:Simple(Some(((33)))),intersect:(("return intersect_box(r, room_red_M);"))),"room_r"),(13):Named(Complex(kind:Simple(Some(((35)))),intersect:(("return intersect_box(r, room_green_M);"))),"room_g"),(14):Named(Complex(kind:Simple(Some(((36)))),intersect:(("return intersect_box(r, room_blue_M);"))),"room_b"),(15):Named(Flat(kind:Portal(Some(((61))),Some(((62)))),is_inside:(("if (two_sided_u == 0) return NOT_INSIDE;\n\nif (back) return NOT_INSIDE;\n\nreturn portal_is_inside(x, y, false, !first, solid_red_M, solid_blue_M);"))),"Portal A1"),(16):Named(Flat(kind:Portal(Some(((64))),Some(((65)))),is_inside:(("if (two_sided_u == 0) return NOT_INSIDE;\n\nif (back) return NOT_INSIDE;\n\nreturn portal_is_inside(x, y, false, !first, solid_green_M, solid_red_M);"))),"Portal B1"),(17):Named(Flat(kind:Portal(Some(((66))),Some(((67)))),is_inside:(("if (two_sided_u == 0) return NOT_INSIDE;\n\nif (back) return NOT_INSIDE;\n\nreturn portal_is_inside(x, y, false, !first, solid_blue_M, solid_green_M);"))),"Portal C1"),(18):Named(Flat(kind:Portal(Some(((68))),Some(((69)))),is_inside:(("if (two_sided_u == 0) return NOT_INSIDE;\n\nif (back) return NOT_INSIDE;\n\nreturn portal_is_inside(x, y, false, !first, solid_green_M, solid_red_M);"))),"Portal A2"),(19):Named(Flat(kind:Portal(Some(((70))),Some(((71)))),is_inside:(("if (two_sided_u == 0) return NOT_INSIDE;\n\nif (back) return NOT_INSIDE;\n\nreturn portal_is_inside(x, y, false, !first, solid_red_M, solid_blue_M);"))),"Portal B2"),(20):Named(Flat(kind:Portal(Some(((72))),Some(((73)))),is_inside:(("if (two_sided_u == 0) return NOT_INSIDE;\n\nif (back) return NOT_INSIDE;\n\nreturn portal_is_inside(x, y, false, !first, solid_blue_M, solid_green_M);"))),"Portal C2")},storage_order:[(0),(1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13),(14),(15),(16),(17),(18),(19),(20)]),cameras:(ids:(available:[],max:8),storage:{(0):Named((look_at:MatrixCenter(Some(((33)))),alpha:-11.401557052673141,beta:1.0425008903741875,r:2.89256198347109),"room_r"),(1):Named((look_at:MatrixCenter(Some(((35)))),alpha:-11.401557052673141,beta:1.0425008903741875,r:2.89256198347109),"room_g"),(2):Named((look_at:MatrixCenter(Some(((36)))),alpha:-11.401557052673141,beta:1.0425008903741875,r:2.89256198347109),"room_b"),(3):Named((look_at:MatrixCenter(Some(((40)))),alpha:-11.37497751033426,beta:0.7205017241090532,r:3.8500000000000236),"portal_r"),(4):Named((look_at:MatrixCenter(Some(((41)))),alpha:-11.37497751033426,beta:0.7205017241090532,r:3.8500000000000236),"portal_g"),(5):Named((look_at:MatrixCenter(Some(((42)))),alpha:-11.37497751033426,beta:0.7205017241090532,r:3.8500000000000236),"portal_b"),(6):Named((look_at:Coordinate((0,0,0)),alpha:-14.515208384038198,beta:2.1655923302345945,r:0.7617019752655252),"picture"),(7):Named((look_at:Coordinate((0,0,0)),alpha:-13.641867310629474,beta:1.4060923153185307,r:0.837872172792078),"picture 3")},storage_order:[(0),(1),(2),(3),(4),(5),(6),(7)]),textures:(ids:(available:[],max:0),storage:{},storage_order:[]),materials:(ids:(available:[],max:16),storage:{(0):Named(Simple(color:(0.7647058823529411,0.7254901960784313,0.49019607843137253),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3),"room_yellow"),(1):Named(Simple(color:(0.029196177,0.029196177,0.029196177),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3),"room_black"),(2):Named(Simple(color:(0.8431372549019608,0.5725490196078431,0.5725490196078431),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3),"room_red"),(3):Named(Simple(color:(0.1803921568627451,0.1803921568627451,0.1803921568627451),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3),"room_gray"),(4):Named(Simple(color:(0.5490196078431373,0.5764705882352941,0.9058823529411765),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3),"room_blue"),(5):Named(Simple(color:(0.5098039215686274,0.7372549019607844,0.5176470588235295),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3),"room_green"),(6):Named(Simple(color:(0.20784313725490197,0.8235294117647058,0.9019607843137255),normal_coef:0.5,grid:true,grid_scale:4,grid_coef:0.3),"portal_blue"),(7):Named(Simple(color:(0.9686274509803922,0.6862745098039216,0.25098039215686274),normal_coef:0.5,grid:true,grid_scale:4,grid_coef:0.3),"portal_orange"),(8):Named(Simple(color:(0.6666666666666666,0.6666666666666666,0.6666666666666666),normal_coef:0.5,grid:true,grid_scale:5,grid_coef:0.3),"gray_grid"),(9):Named(Simple(color:(0,0,0),normal_coef:0.5,grid:false,grid_scale:4,grid_coef:0.3),"solid_black"),(10):Named(Simple(color:(0.7411764705882353,0.7411764705882353,0.7411764705882353),normal_coef:0.5,grid:false,grid_scale:4,grid_coef:0.3),"solid_white"),(11):Named(Complex(code:(("MaterialProcessing result = material_simple(hit, r, vec3(1e0, 0e0, 0e0), 5e-1, false, 4e0, 3e-1);\nresult.mul_to_color *= color_progress_u;\nreturn result;"))),"solid_red"),(12):Named(Complex(code:(("MaterialProcessing result = material_simple(hit, r, vec3(0e0, 3.3666754e-1, 1e0), 5e-1, false, 4e0, 3e-1);\nresult.mul_to_color *= color_progress_u;\nreturn result;"))),"solid_blue"),(13):Named(Complex(code:(("MaterialProcessing result = material_simple(hit, r, vec3(0e0, 6.8834305e-1, 5.300317e-2), 5e-1, false, 4e0, 3e-1);\nresult.mul_to_color *= color_progress_u;\nreturn result;"))),"solid_green"),(14):Named(Simple(color:(0.9254901960784314,0.9254901960784314,0.9254901960784314),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3),"room_white2"),(15):Named(Simple(color:(0.2823529411764706,0.2823529411764706,0.2823529411764706),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3),"room_black2")},storage_order:[(0),(2),(1),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13),(14),(15)]),intersection_materials:(ids:(available:[],max:0),storage:{},storage_order:[]),library:(ids:(available:[],max:4),storage:{(0):Named((("int is_inside_square(float x, float y, float sizex, float sizey, int material) {\n  if (abs(x) < sizex && abs(y) < sizey) {\n    return material;\n  } else {\n    return NOT_INSIDE;\n  }\n}\n")),"room"),(1):Named((("int portal_is_inside(float x, float y, bool back, bool first, int material1, int material2) {\nint material = material1;\nif (first) material = material2;\n\nint teleport = TELEPORT;\nif (teleport_light_u == 0) teleport = gray_grid_M; \nif (back) teleport = material;\n\nif (between(0., x, side_border_u) && \n    between(0., abs(y), height_u + border_u)) {\n  if (between(0., x, black_border_u) ||\n      (between(side_border_u-black_border_u, x, side_border_u) && \n       between(0., abs(y), height_u + black_border_u)) &&\n      !back) {\n    return solid_black_M;\n  } else {\n    return material;\n  }\n} else if (between(0., abs(y), height_u) && \n           between(0., x, width_u)) {\n  return teleport;\n} else if (between(0., abs(y), height_u + border_u) && \n           between(0., x, width_u + border_u)) {\n  if (between(0., abs(y), height_u + black_border_u) && \n      between(0., x, width_u + black_border_u) && \n      !back) {\n    return solid_black_M;\n  } else {\n    return material;\n  }\n} else if (between(0., abs(y), height_u + border_u + black_border_u) && \n           between(0., x, width_u + border_u + black_border_u)) {\n  return solid_black_M;\n} else {\n  return NOT_INSIDE;\n}\n}")),"portal"),(2):Named((("int is_inside_polygon(float x, float y) {\n  float border_ = 0.03 * polygon_size_u;\n  int inner = solid_white_M;\n  int border= solid_black_M;\n  float height = 0.6 * polygon_size_u;\n  float width = 0.5 * polygon_size_u;\n  float slant = 0.4;\n  if (between(border_, y, slant * x + height) && abs(x) < width) {\n    return inner;\n  } else if (between(0., y, slant * x + height + border_) && abs(x) < width + border_) {\n    return border;\n  } else {\n    return NOT_INSIDE;\n  }\n}")),"polygon"),(3):Named((("SceneIntersection intersect_box(Ray r, int material) {\nvec3 rad = vec3(4., 4., 4.);\nvec3 m = 1.0/r.d.xyz;\nvec3 n = m*r.o.xyz;\nvec3 k = abs(m)*rad;\nvec3 t1 = -n - k;\nvec3 t2 = -n + k;\n\nfloat tN = max( max( t1.x, t1.y ), t1.z );\nfloat tF = min( min( t2.x, t2.y ), t2.z );\n\nfloat t = tN;\nif (tN < 0.0 && tF > 0.0) t = tF;\n\nif(tN > tF) return scene_intersection_none;\n\nif(t < 0.0) return scene_intersection_none;\n\nvec3 oN = -sign(r.d.xyz)*step(t1.yzx,t1.xyz)*step(t1.zxy,t1.xyz);\n\nvec3 pos = (r.o + r.d * t).xyz;\n\nvec2 uv = vec2(pos.x, pos.y);\nif (abs(abs(pos.x) - rad.x) < 0.0001) {\n  uv = vec2(pos.y, pos.z);\n}\nif (abs(abs(pos.y) - rad.y) < 0.0001) {\n  uv = vec2(pos.x, pos.z);\n}\n\nreturn SceneIntersection(material, SurfaceIntersection(true, t, uv.x, uv.y, normalize_normal(r.d.xyz, oN)));\n}")),"box")},storage_order:[(0),(1),(2),(3)]),animations_filters:(uniforms:({((13)):true,((10)):true,((32)):false,((41)):false,((12)):true,((2)):false,((30)):true,((0)):false,((8)):false,((14)):true,((6)):true,((1)):false,((31)):true,((11)):false,((7)):false,((38)):false,((40)):false,((9)):false,((33)):false,((35)):false,((34)):true,((39)):true}),matrices:({((24)):false,((63)):false,((35)):false,((15)):false,((42)):true,((0)):false,((26)):false,((33)):false,((40)):true,((36)):false,((17)):true,((18)):true,((23)):true,((20)):true,((13)):true,((19)):true,((21)):true,((14)):false,((16)):false,((41)):true}),cameras:({((3)):true,((5)):true,((7)):false,((2)):true,((4)):true,((1)):true,((6)):false,((0)):true})),elements_descriptions:(uniforms:({((39)):(help_description:None,overrided_name:"Speed"),((31)):(help_description:None,overrided_name:"Gray room"),((10)):(help_description:None,overrided_name:""),((30)):(help_description:None,overrided_name:"Enable second side"),((12)):(help_description:None,overrided_name:""),((14)):(help_description:None,overrided_name:"Progress"),((32)):(help_description:None,overrided_name:"a"),((11)):(help_description:None,overrided_name:""),((13)):(help_description:None,overrided_name:""),((34)):(help_description:None,overrided_name:"c"),((33)):(help_description:None,overrided_name:"b"),((6)):(help_description:None,overrided_name:"Teleport light")}),matrices:({((13)):(help_description:None,overrided_name:"Symmetric"),((23)):(help_description:None,overrided_name:"Polygon"),((41)):(help_description:None,overrided_name:""),((20)):(help_description:None,overrided_name:"Green portal"),((42)):(help_description:None,overrided_name:""),((21)):(help_description:None,overrided_name:"Blue portal"),((17)):(help_description:None,overrided_name:""),((19)):(help_description:None,overrided_name:"Red portal"),((18)):(help_description:None,overrided_name:""),((40)):(help_description:None,overrided_name:"")}),cameras:({((4)):(help_description:None,overrided_name:"Look at green portal"),((3)):(help_description:None,overrided_name:"Look at red portal"),((0)):(help_description:None,overrided_name:"Red room"),((5)):(help_description:None,overrided_name:"Look at blue portal"),((2)):(help_description:None,overrided_name:"Blue room"),((1)):(help_description:None,overrided_name:"Green room")})),user_uniforms:(uniforms:({((1)):false,((34)):false,((10)):false,((33)):false,((40)):false,((7)):false,((2)):false,((41)):false,((38)):false,((13)):false,((6)):true,((0)):false,((12)):false,((8)):false,((9)):false,((32)):false,((30)):true,((35)):false,((11)):false,((14)):false,((31)):true,((39)):false}),matrices:({((14)):false,((26)):false,((23)):false,((17)):false,((40)):false,((36)):false,((19)):false,((21)):false,((33)):false,((41)):false,((18)):false,((16)):false,((15)):false,((35)):false,((20)):false,((13)):false,((0)):false,((63)):false,((42)):false,((24)):false})),animation_stages:(ids:(available:[],max:10),storage:{(0):Named((name:(eng:"From triple doorway",rus:"Из тройной двери"),description:Some((eng:"If we cut space-tipe in shape of triple doorway, then we can get this portal.",rus:"Если мы разрежем пространство-время в форме тройной двери, то сможем получить данный портал.")),uniforms:({((0)):FromDev,((14)):ProvidedToUser,((12)):Changed(Some(((24)))),((7)):FromDev,((10)):FromDev,((8)):FromDev,((11)):FromDev,((9)):FromDev,((6)):FromDev,((2)):FromDev,((13)):Changed(Some(((15)))),((1)):FromDev}),matrices:({((33)):FromDev,((18)):FromDev,((26)):FromDev,((15)):FromDev,((19)):FromDev,((13)):Changed(Some(((38)))),((42)):FromDev,((40)):FromDev,((14)):FromDev,((36)):FromDev,((24)):FromDev,((0)):FromDev,((35)):FromDev,((41)):FromDev,((20)):FromDev,((16)):FromDev,((21)):FromDev,((23)):FromDev,((17)):FromDev}),original_cam_button:false,set_cam:None,cams:{((4)):false,((1)):false,((3)):false,((2)):false,((5)):false,((0)):false}),"triple doorway"),(1):Named((name:(eng:"From three doorways",rus:"Из трёх дверных проёмов"),description:Some((eng:"It\'s also possible to construct this portal from three pairs of classic dual portals, but glued on one side with precise angles.",rus:"Так же данный портал возможно собрать из трёх пар обычных порталов, склеив их, очень точно соблюдая углы.")),uniforms:({((13)):Changed(Some(((22)))),((10)):Changed(Some(((21)))),((1)):FromDev,((2)):FromDev,((6)):FromDev,((7)):FromDev,((11)):FromDev,((8)):FromDev,((12)):Changed(Some(((23)))),((14)):ProvidedToUser,((9)):FromDev,((0)):FromDev}),matrices:({((23)):FromDev,((17)):Changed(Some(((39)))),((35)):FromDev,((24)):FromDev,((16)):FromDev,((13)):FromDev,((18)):Changed(Some(((46)))),((15)):FromDev,((42)):FromDev,((33)):FromDev,((14)):FromDev,((41)):FromDev,((20)):FromDev,((26)):FromDev,((40)):FromDev,((0)):FromDev,((36)):FromDev,((19)):FromDev,((21)):FromDev}),original_cam_button:false,set_cam:None,cams:{((3)):false,((5)):false,((0)):false,((1)):false,((2)):false,((4)):false}),"three doorways"),(2):Named((name:(eng:"Three worlds",rus:"Три вселенных"),description:Some((eng:"As regular portals can connect two different worlds, this portal can connect three different worlds, and worlds here represented as colored rooms.",rus:"Подобному тому как обычные порталы могут соединять две различных вселенных, данный портал может соединять три различных вселенных.")),uniforms:({((2)):FromDev,((12)):FromDev,((7)):FromDev,((6)):FromDev,((0)):FromDev,((11)):FromDev,((9)):FromDev,((10)):FromDev,((13)):FromDev,((1)):FromDev,((8)):FromDev,((14)):FromDev}),matrices:({((20)):ProvidedToUser,((13)):Changed(Some(((47)))),((41)):Changed(Some(((49)))),((14)):FromDev,((17)):FromDev,((36)):FromDev,((35)):FromDev,((21)):ProvidedToUser,((24)):FromDev,((15)):FromDev,((19)):ProvidedToUser,((18)):FromDev,((23)):FromDev,((42)):Changed(Some(((50)))),((40)):Changed(Some(((48)))),((16)):FromDev,((26)):FromDev,((0)):FromDev,((33)):FromDev}),original_cam_button:false,set_cam:Some(Some(((0)))),cams:{((2)):true,((3)):false,((4)):false,((5)):false,((0)):true,((1)):true}),"worlds"),(3):Named((name:(eng:"Explore",rus:"Исследуй"),description:Some((eng:"- `Symmetric` is set one transformation to three portals simultaneously. I recommend to play with this paramater especially, because you will receive symmetric images.\n- `Red/Green/Blue portal` set transformation for each portal.\n- `Polygon` is set transformation for the polygon. This polygon can be teleported only through red portal once (because more teleportation is harder to implement).",rus:"- `Symmetric` задаёт одну трансформацию ко всем трём порталам одновременно. Я особенно рекомендую поиграться с этим параметром, потому что с ним получаются симметричные изображения.\n- `Red/Green/Blue portal` задают трансформации для каждого портала по отдельности.\n- `Polygon` задаёт трансформацию многоугольнику. Этот многоугольник может быть телепортирован только через красный портал единожды (потому что реализовать больше телепораций сложнее).")),uniforms:({((6)):FromDev,((0)):FromDev,((1)):FromDev,((9)):FromDev,((2)):FromDev,((11)):FromDev,((10)):FromDev,((13)):FromDev,((12)):FromDev,((7)):FromDev,((8)):FromDev,((14)):FromDev}),matrices:({((21)):ProvidedToUser,((23)):ProvidedToUser,((33)):FromDev,((16)):FromDev,((42)):FromDev,((36)):FromDev,((35)):FromDev,((24)):FromDev,((15)):FromDev,((26)):FromDev,((19)):ProvidedToUser,((20)):ProvidedToUser,((41)):FromDev,((18)):FromDev,((40)):FromDev,((17)):FromDev,((14)):FromDev,((13)):ProvidedToUser,((0)):FromDev}),original_cam_button:true,set_cam:None,cams:{((2)):false,((4)):true,((3)):true,((5)):true,((0)):false,((1)):false}),"explore"),(4):Named((name:(eng:"Picture 1",rus:"Картинка 1"),description:None,uniforms:({((13)):FromDev,((10)):FromDev,((9)):FromDev,((12)):Changed(Some(((27)))),((11)):FromDev,((6)):FromDev,((2)):FromDev,((8)):FromDev,((14)):FromDev,((7)):FromDev,((0)):FromDev,((1)):FromDev}),matrices:({((36)):FromDev,((17)):FromDev,((19)):FromDev,((26)):FromDev,((41)):FromDev,((33)):FromDev,((23)):FromDev,((42)):FromDev,((18)):FromDev,((20)):FromDev,((21)):FromDev,((40)):FromDev,((16)):FromDev,((0)):FromDev,((35)):FromDev,((15)):FromDev,((13)):ChangedAndToUser(Some(((56)))),((14)):FromDev,((24)):FromDev}),original_cam_button:false,set_cam:Some(Some(((6)))),cams:{((2)):false,((3)):false,((0)):false,((4)):false,((1)):false,((5)):false}),"pic 1"),(5):Named((name:(eng:"Picture 2",rus:"Картинка 2"),description:None,uniforms:({((8)):FromDev,((7)):FromDev,((13)):FromDev,((10)):FromDev,((14)):FromDev,((11)):FromDev,((0)):FromDev,((9)):FromDev,((12)):Changed(Some(((29)))),((1)):FromDev,((6)):FromDev,((2)):FromDev}),matrices:({((0)):FromDev,((41)):FromDev,((14)):FromDev,((23)):FromDev,((33)):FromDev,((15)):FromDev,((36)):FromDev,((13)):ChangedAndToUser(Some(((57)))),((21)):FromDev,((17)):FromDev,((26)):FromDev,((24)):FromDev,((16)):FromDev,((35)):FromDev,((18)):FromDev,((40)):FromDev,((42)):FromDev,((20)):FromDev,((19)):FromDev}),original_cam_button:false,set_cam:Some(Some(((6)))),cams:{((4)):false,((5)):false,((3)):false,((2)):false,((1)):false,((0)):false}),"pic 2"),(6):Named((name:(eng:"Picture 3",rus:"Картинка 3"),description:None,uniforms:({((14)):FromDev,((2)):FromDev,((1)):FromDev,((7)):FromDev,((13)):FromDev,((10)):FromDev,((11)):FromDev,((9)):FromDev,((0)):FromDev,((8)):FromDev,((12)):Changed(Some(((28)))),((6)):FromDev}),matrices:({((23)):FromDev,((18)):FromDev,((26)):FromDev,((35)):FromDev,((40)):FromDev,((14)):FromDev,((36)):FromDev,((17)):FromDev,((41)):FromDev,((13)):ChangedAndToUser(Some(((58)))),((21)):FromDev,((0)):FromDev,((20)):FromDev,((15)):FromDev,((33)):FromDev,((24)):FromDev,((19)):FromDev,((16)):FromDev,((42)):FromDev}),original_cam_button:false,set_cam:Some(Some(((7)))),cams:{((1)):false,((0)):false,((4)):false,((3)):false,((5)):false,((2)):false}),"pic 3"),(7):Named((name:(eng:"Show polygon",rus:"С многоугольником"),description:Some((eng:"You can see that polygon is saved their shape when it teleported through this triple portal.",rus:"Вы можете видеть что полигон сохраняет свою форму после вхождения в тройной портал.")),uniforms:({((14)):ProvidedToUser,((1)):FromDev,((10)):FromDev,((13)):FromDev,((12)):Changed(Some(((26)))),((7)):FromDev,((6)):FromDev,((2)):FromDev,((11)):FromDev,((8)):FromDev,((0)):FromDev,((9)):FromDev}),matrices:({((19)):FromDev,((36)):FromDev,((17)):FromDev,((16)):FromDev,((41)):FromDev,((23)):Changed(Some(((54)))),((14)):FromDev,((33)):FromDev,((42)):FromDev,((21)):FromDev,((0)):FromDev,((20)):FromDev,((35)):FromDev,((13)):FromDev,((26)):FromDev,((40)):FromDev,((18)):FromDev,((24)):FromDev,((15)):FromDev}),original_cam_button:false,set_cam:None,cams:{((4)):false,((0)):false,((3)):false,((1)):false,((5)):false,((2)):false}),"show polygon"),(8):Named((name:(eng:"Picture 4",rus:"Картинка 4"),description:Some((eng:"Triple portal can be connected in such way that it produces hexagonal tiling monoportal.",rus:"Тройной портал может быть соединён таким способом, что он образует монопортал шестиугольного замощения.")),uniforms:({((6)):FromDev,((7)):FromDev,((8)):FromDev,((2)):FromDev,((11)):FromDev,((1)):FromDev,((10)):FromDev,((12)):FromDev,((9)):FromDev,((13)):FromDev,((0)):FromDev,((14)):FromDev}),matrices:({((20)):FromDev,((40)):FromDev,((26)):FromDev,((13)):ChangedAndToUser(Some(((59)))),((15)):FromDev,((42)):FromDev,((36)):FromDev,((0)):FromDev,((21)):FromDev,((19)):FromDev,((35)):FromDev,((33)):FromDev,((24)):FromDev,((16)):FromDev,((14)):FromDev,((17)):FromDev,((18)):FromDev,((23)):ChangedAndToUser(Some(((60)))),((41)):FromDev}),original_cam_button:false,set_cam:None,cams:{((0)):false,((4)):false,((2)):false,((1)):false,((5)):false,((3)):false}),"pic 4"),(9):Named((name:(eng:"Animation",rus:"Анимация"),description:None,uniforms:({((41)):FromDev,((0)):FromDev,((9)):FromDev,((39)):ProvidedToUser,((30)):FromDev,((7)):FromDev,((10)):FromDev,((1)):FromDev,((12)):Changed(Some(((34)))),((31)):FromDev,((2)):FromDev,((35)):FromDev,((38)):FromDev,((33)):FromDev,((13)):FromDev,((40)):FromDev,((8)):FromDev,((6)):FromDev,((32)):FromDev,((34)):ProvidedToUser,((11)):FromDev,((14)):FromDev}),matrices:({((19)):FromDev,((40)):FromDev,((0)):FromDev,((42)):FromDev,((23)):FromDev,((13)):Changed(Some(((74)))),((18)):FromDev,((20)):FromDev,((14)):FromDev,((33)):FromDev,((63)):FromDev,((24)):FromDev,((36)):FromDev,((41)):FromDev,((21)):FromDev,((35)):FromDev,((15)):FromDev,((16)):FromDev,((17)):FromDev,((26)):FromDev}),original_cam_button:false,set_cam:None,cams:{((1)):false,((3)):false,((2)):false,((4)):false,((5)):false,((0)):false}),"Animation")},storage_order:[(0),(1),(7),(2),(3),(4),(5),(6),(8),(9)]),current_stage:Some(((3))),dev_stage:(uniforms:({((31)):Bool(false),((39)):Float((min:None,max:None,value:0.25)),((13)):Progress(1),((2)):Float((min:Some(0),max:None,value:4)),((1)):Float((min:Some(0),max:None,value:4)),((7)):Float((min:None,max:None,value:0.64)),((11)):Float((min:None,max:None,value:0.01)),((12)):Progress(1),((8)):Float((min:None,max:None,value:1.56)),((14)):Progress(0),((30)):Bool(false),((32)):Float((min:None,max:None,value:1.17)),((10)):Progress(0),((33)):Float((min:None,max:None,value:3)),((6)):Bool(true),((9)):Float((min:None,max:None,value:0.13)),((38)):Formula(("((time*speed)*180)%360")),((35)):Formula(("t1%180")),((0)):Float((min:Some(0),max:None,value:4))}),matrices:({((20)):Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((19)):Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((36)):Simple(offset:(0,0,9),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((0)):Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((21)):Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((16)):Simple(offset:(0,0,0),scale:1,rotate:(0,4.1887902047863905,0),mirror:(false,false,false)),((35)):Simple(offset:(0,9,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((24)):Teleport(first_portal:Some(((27))),second_portal:Some(((29))),what:Some(((23)))),((33)):Simple(offset:(9,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((18)):Simple(offset:(0,0,0),scale:1,rotate:(0,3.6651914291880923,0),mirror:(false,false,false)),((17)):Simple(offset:(0,0,0),scale:1,rotate:(0,5.759586531581287,0),mirror:(false,false,false)),((15)):Simple(offset:(0,0,0),scale:1,rotate:(0,2.0943951023931953,0),mirror:(false,false,false)),((42)):Mul(to:Some(((45))),what:Some(((16)))),((41)):Mul(to:Some(((44))),what:Some(((15)))),((26)):Teleport(first_portal:Some(((30))),second_portal:Some(((32))),what:Some(((23)))),((63)):Simple(offset:(0,0,0),scale:1,rotate:(0,1.5707963267948966,0),mirror:(false,false,false)),((23)):Simple(offset:(-0.08,0,3.7),scale:1,rotate:(4.71238898038469,0,0),mirror:(false,false,false)),((40)):Mul(to:Some(((43))),what:Some(((14)))),((13)):Simple(offset:(0,0,0.5),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((14)):Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false))})),use_time:true)