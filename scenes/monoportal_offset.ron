(desc:(eng:"# Ofsetting monoportal\n\nThis portals works like regular monoportal, but with offsetting by half of its length.\n\nIt can exists only with help of the supporting portals.\n\nAlso, this portal can be constructed by another way: look «Offsetting monoportal 2» scene.\n\nIdea of that portal came to me when I tried to sleep. Glad I always write pre-sleep thoughts.",rus:"# Смещающий монопортал\n\nЭтот портал работает как обычный монопортал, но дополнительно смещает всё на половину своей высоты.\n\nОн может существовать только благодаря помощи поддерживающих порталов.\n\nТак же данный портал может быть сконструирован другим способом, смотрите сцену «Offsetting monoportal 2».\n\nИдея такого портала случайно пришла ко мне в голову, когда я пытался заснуть. Хорошо что я всегда записываю мысли перед сном."),cam:(look_at:(0,0,0),alpha:1.2162617125499164,beta:1.298001445084804,r:3.8500000000000254,offset_after_material:0.000025),uniforms:(ids:(available:[],max:44),storage:{(0):Named(Float((min:Some(0),max:None,value:4)),"room_size_x"),(1):Named(Float((min:Some(0),max:None,value:4)),"room_size_y"),(2):Named(Float((min:Some(0),max:None,value:4)),"room_size_z"),(3):Inline(Formula(("-room_size_x"))),(4):Inline(Formula(("-room_size_y"))),(5):Inline(Formula(("-room_size_z"))),(6):Named(Float((min:Some(0),max:Some(0.5),value:0.5)),"offset"),(7):Named(Float((min:None,max:None,value:0.13)),"border"),(8):Named(Progress(0),"border_up_down"),(9):Named(Float((min:Some(0),max:None,value:0)),"supp_offset"),(10):Named(Formula(("1.0 + progress * 1.5")),"width"),(11):Named(Formula(("1.0 + progress * 3.0 - 0.001")),"height"),(12):Named(Bool(true),"teleport_light"),(13):Inline(Formula(("offset * height * 2"))),(14):Inline(Formula(("-(supp_offset + height)"))),(15):Inline(Formula(("supp_offset + height"))),(16):Named(Formula(("inv(on(progress, 0, 0.2)) * 0.3")),"supp_r_near"),(17):Named(Formula(("inv(on(progress, 0.2, 1.0))")),"supp_r_far"),(18):Named(Progress(1),"supp_r"),(19):Inline(Progress(1)),(20):Inline(Float((min:None,max:None,value:0))),(21):Inline(Float((min:None,max:None,value:10))),(22):Named(Progress(1),"progress"),(23):Inline(Float((min:None,max:None,value:0.5))),(24):Inline(Formula(("1.0 - on(progress, 0.7, 1.0)"))),(25):Inline(Formula(("on(progress, 0, 0.3)"))),(26):Inline(Formula(("inv(on(progress, 0.3, 1.0)) * 1.5"))),(27):Inline(Float((min:None,max:None,value:1))),(28):Inline(Float((min:Some(0),max:Some(0.5),value:0.5))),(29):Inline(Float((min:None,max:None,value:1))),(30):Inline(Formula(("1.0"))),(31):Inline(Formula(("1.0 + 0.3"))),(32):Inline(Formula(("1.0 + progress * 1.5"))),(33):Inline(Formula(("1.0 + progress * 3.0 - 0.001"))),(34):Inline(Formula(("inv(on(progress, 0.2, 1.0))"))),(35):Inline(Formula(("1.0"))),(36):Inline(Formula(("0.3"))),(37):Inline(Formula(("0.3"))),(38):Inline(Formula(("inv(on(progress, 0, 0.2)) * 0.3"))),(39):Inline(Float((min:Some(0),max:Some(0.5),value:0))),(40):Named(Float((min:Some(-0.75),max:Some(0.75),value:-0.33)),"triangle_x"),(41):Named(Float((min:Some(-0.75),max:Some(0.75),value:-0.17000000000000004)),"triangle_y"),(42):Named(Bool(false),"triangle_enabled"),(43):Inline(Bool(true))},storage_order:[(0),(1),(2),(6),(7),(8),(10),(11),(12),(9),(16),(17),(18),(22),(40),(41),(42)]),matrices:(ids:(available:[],max:19),storage:{(0):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"room_origin"),(1):Inline(Mul(to:Some(((2))),what:Some(((0))))),(2):Inline(Parametrized(offset:(x:Yes(Some(((0)))),y:No(0),z:No(0)),rotate:(x:No(0),y:No(1.5707963267948966),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(3):Inline(Mul(to:Some(((4))),what:Some(((0))))),(4):Inline(Parametrized(offset:(x:Yes(Some(((3)))),y:No(0),z:No(0)),rotate:(x:No(0),y:No(1.5707963267948966),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(5):Inline(Mul(to:Some(((6))),what:Some(((0))))),(6):Inline(Parametrized(offset:(x:No(0),y:Yes(Some(((1)))),z:No(0)),rotate:(x:No(1.5707963267948966),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(7):Inline(Mul(to:Some(((8))),what:Some(((0))))),(8):Inline(Parametrized(offset:(x:No(0),y:Yes(Some(((4)))),z:No(0)),rotate:(x:No(1.5707963267948966),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(9):Inline(Mul(to:Some(((10))),what:Some(((0))))),(10):Inline(Parametrized(offset:(x:No(0),y:No(0),z:Yes(Some(((2))))),rotate:(x:No(0),y:No(0),z:No(0)),mirror:(x:No(1),y:No(0),z:No(0)),scale:No(1))),(11):Inline(Mul(to:Some(((12))),what:Some(((0))))),(12):Inline(Parametrized(offset:(x:No(0),y:No(0),z:Yes(Some(((5))))),rotate:(x:No(0),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(13):Inline(Parametrized(offset:(x:Yes(Some(((40)))),y:Yes(Some(((41)))),z:No(0.75)),rotate:(x:No(4.71238898038469),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))),(14):Named(Teleport(first_portal:Some(((16))),second_portal:Some(((15))),what:Some(((17)))),"b_teleported"),(15):Named(Parametrized(offset:(x:No(0),y:Yes(Some(((14)))),z:No(0)),rotate:(x:No(4.71238898038469),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1)),"supp_a"),(16):Named(Parametrized(offset:(x:No(0),y:Yes(Some(((15)))),z:No(0)),rotate:(x:No(4.71238898038469),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1)),"supp_b"),(17):Named(Parametrized(offset:(x:No(0),y:Yes(Some(((13)))),z:No(0)),rotate:(x:No(0),y:No(3.141592653589793),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1)),"b"),(18):Named(Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),"a")},storage_order:[(0),(15),(16),(18),(17),(14)]),objects:(ids:(available:[],max:10),storage:{(0):Named(Flat(kind:Simple(Some(((1)))),is_inside:(("return is_inside_square(x, y, room_size_z_u, room_size_y_u, room_yellow_M);"))),"room_x+"),(1):Named(Flat(kind:Simple(Some(((3)))),is_inside:(("return is_inside_square(x, y, room_size_z_u, room_size_y_u, room_red_M);"))),"room_x-"),(2):Named(Flat(kind:Simple(Some(((5)))),is_inside:(("return is_inside_square(x, y, room_size_x_u, room_size_z_u, room_black_M);"))),"room_y+"),(3):Named(Flat(kind:Simple(Some(((7)))),is_inside:(("return is_inside_square(x, y, room_size_x_u, room_size_z_u, room_gray_M);"))),"room_y-"),(4):Named(Flat(kind:Simple(Some(((9)))),is_inside:(("return is_inside_square(x, y, room_size_x_u, room_size_y_u, room_blue_texture_M);"))),"room_z+"),(5):Named(Flat(kind:Simple(Some(((11)))),is_inside:(("return is_inside_square(x, y, room_size_x_u, room_size_y_u, room_green_M);"))),"room_z-"),(6):Named(Flat(kind:Portal(Some(((18))),Some(((17)))),is_inside:(("vec4 pos1 = pos;\nif (first) { pos1 = a_to_b_mat_teleport * pos; }\n\nif ((supp_b_mat_inv * pos1).z > 0.) return NOT_INSIDE;\n\nreturn is_inside_portal(x, y, back, room_red_M);"))),"portal"),(7):Named(Flat(kind:Portal(Some(((15))),Some(((16)))),is_inside:(("float r = (width_u + supp_r_near_u) * supp_r_u;\nif (y > 0.) r *= supp_r_far_u;\nfloat border = border_u * supp_r_u;\nif (y > 0.) border *= supp_r_far_u;\n\nif (x*x + y*y < sqr(r) && !back) {\n  if (teleport_light_u == 0) return room_blue_M;\n  return TELEPORT;\n} else if (x*x + y*y < sqr(r + border)) {\n  return solid_black_M;\n} else {\n  return NOT_INSIDE;\n}"))),"support portals"),(8):Named(Flat(kind:Portal(Some(((18))),Some(((14)))),is_inside:(("vec4 pos1 = pos;\nif (first) { pos1 = a_to_b_mat_teleport * pos; }\n\nif ((supp_a_mat_inv * pos1).z < 0.) return NOT_INSIDE;\n\nreturn is_inside_portal(x, y, back, room_green_M);"))),"portal_teleported"),(9):Named(Flat(kind:Simple(Some(((13)))),is_inside:(("return is_inside_triangle(x, y, 2.0, float(triangle_enabled_u), 0.02, triangle_white_M, triangle_black_M);"))),"triangle")},storage_order:[(0),(1),(2),(3),(4),(5),(6),(8),(7),(9)]),cameras:(ids:(available:[],max:0),storage:{},storage_order:[]),textures:(ids:(available:[],max:1),storage:{(0):Named(("scenes/monoportal_offset.png"),"monoportal")},storage_order:[(0)]),materials:(ids:(available:[],max:13),storage:{(0):Named(Simple(color:(0.8980392156862745,0.8313725490196079,0.25098039215686274),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3,grid2:false,grid3:true),"room_yellow"),(1):Named(Simple(color:(0.050980392156862744,0.050980392156862744,0.050980392156862744),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3,grid2:false,grid3:true),"room_black"),(2):Named(Simple(color:(0.9058823529411765,0.29411764705882354,0.29411764705882354),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3,grid2:false,grid3:true),"room_red"),(3):Named(Simple(color:(0.2235294117647059,0.2235294117647059,0.2235294117647059),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3,grid2:false,grid3:true),"room_gray"),(4):Named(Simple(color:(0.3137254901960784,0.38823529411764707,0.9254901960784314),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3,grid2:false,grid3:true),"room_blue"),(5):Named(Simple(color:(0.2627450980392157,0.8470588235294118,0.30196078431372547),normal_coef:0.5,grid:true,grid_scale:1,grid_coef:0.3,grid2:false,grid3:true),"room_green"),(6):Named(Simple(color:(0.03557645,0.6446965,0.79122156),normal_coef:0.5,grid:true,grid_scale:4,grid_coef:0.3),"portal_blue"),(7):Named(Simple(color:(0.9317271,0.42666554,0.051948573),normal_coef:0.5,grid:true,grid_scale:4,grid_coef:0.3),"portal_orange"),(8):Named(Simple(color:(0.6666666666666666,0.6666666666666666,0.6666666666666666),normal_coef:0.5,grid:true,grid_scale:5,grid_coef:0.3),"grid_gray"),(9):Named(Simple(color:(0,0,0),normal_coef:0.5,grid:false,grid_scale:4,grid_coef:0.3),"solid_black"),(10):Named(Complex(code:(("MaterialProcessing result = material_simple2(hit, r, vec3(3.137254901960784e-1, 3.8823529411764707e-1, 9.254901960784314e-1), 5e-1, true, 1.0, 3e-1, false, true);\nresult.mul_to_color *= texture(monoportal_tex, vec2(room_size_x_u + hit.u, room_size_x_u-hit.v) / (room_size_x_u * 2.0)).rgb;\nreturn result;"))),"room_blue_texture"),(11):Named(Simple(color:(0.8196078431372549,0.8196078431372549,0.8196078431372549),normal_coef:0.5,grid:false,grid_scale:4,grid_coef:0.3),"triangle_white"),(12):Named(Simple(color:(0.058823529411764705,0.058823529411764705,0.058823529411764705),normal_coef:0.5,grid:false,grid_scale:4,grid_coef:0.3),"triangle_black")},storage_order:[(0),(2),(1),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12)]),library:(ids:(available:[],max:3),storage:{(0):Named((("int is_inside_square(float x, float y, float sizex, float sizey, int material) {\n  if (abs(x) < sizex && abs(y) < sizey) {\n    return material;\n  } else {\n    return NOT_INSIDE;\n  }\n}\n")),"room"),(1):Named((("int is_inside_portal(float x, float y, bool back, int portal_material) {\nif (x < 0.) return NOT_INSIDE;\nif (x > width_u + border_u) return NOT_INSIDE;\nif (x > width_u && between(0., abs(y), height_u + border_up_down_u * border_u)) return solid_black_M;\n\nif (abs(y) > height_u + border_up_down_u * border_u) return NOT_INSIDE;\nif (abs(y) > height_u) return solid_black_M;\n\nif (back) return solid_black_M;\nif (teleport_light_u == 0) return portal_material;\n\nreturn TELEPORT;\n}")),"portal"),(2):Named((("int is_inside_triangle(float x, float y, float angle, float width, float border, int inner_m, int border_m) {\n  float value = width * 0.7 - abs(x)*angle;\n  if (between(border, y, value - border * angle)) {\n    return inner_m;\n  } else if (between(0., y, value)) {\n    return border_m;\n  } else {\n    return NOT_INSIDE;\n  }\n}")),"triangle")},storage_order:[(0),(1),(2)]),animations_filters:(uniforms:({((18)):true,((2)):false,((1)):false,((9)):true,((10)):true,((17)):true,((12)):true,((11)):true,((16)):true,((6)):true,((40)):true,((41)):true,((7)):false,((42)):true,((22)):true,((8)):true,((0)):false}),matrices:({((15)):false,((18)):false,((0)):false,((16)):false,((14)):false,((17)):false}),cameras:({})),elements_descriptions:(uniforms:({((17)):(help_description:None,overrided_name:""),((40)):(help_description:None,overrided_name:"Triangle X"),((8)):(help_description:None,overrided_name:""),((18)):(help_description:None,overrided_name:""),((11)):(help_description:None,overrided_name:""),((12)):(help_description:None,overrided_name:"Teleport light"),((41)):(help_description:None,overrided_name:"Triangle Y"),((42)):(help_description:None,overrided_name:""),((9)):(help_description:None,overrided_name:""),((6)):(help_description:None,overrided_name:"Offset"),((10)):(help_description:None,overrided_name:""),((16)):(help_description:None,overrided_name:""),((22)):(help_description:None,overrided_name:"Progress")}),matrices:({}),cameras:({})),user_uniforms:(uniforms:({((12)):true,((11)):false,((0)):false,((41)):false,((1)):false,((22)):false,((2)):false,((7)):false,((6)):false,((8)):false,((42)):false,((10)):false,((9)):false,((17)):false,((18)):false,((16)):false,((40)):false}),matrices:({((0)):false,((17)):false,((14)):false,((15)):false,((16)):false,((18)):false})),animation_stages:(ids:(available:[],max:4),storage:{(0):Named((name:(eng:"Offset one part",rus:"Смещаем одну часть"),description:Some((eng:"Take regular monoportal and offset one of its part precisely by half of its length.",rus:"Берём обычный монопортал и смещаем его часть ровно на половину его высоты.")),uniforms:({((41)):FromDev,((11)):FromDev,((12)):FromDev,((42)):FromDev,((18)):Changed(Some(((20)))),((10)):FromDev,((9)):Changed(Some(((21)))),((1)):FromDev,((17)):FromDev,((22)):FromDev,((8)):Changed(Some(((19)))),((0)):FromDev,((16)):FromDev,((2)):FromDev,((7)):FromDev,((40)):FromDev,((6)):ChangedAndToUser(Some(((39))))}),matrices:({((0)):FromDev,((14)):FromDev,((15)):FromDev,((18)):FromDev,((17)):FromDev,((16)):FromDev}),original_cam_button:false,set_cam:None,cams:{}),"offset"),(1):Named((name:(eng:"Add support portals and teleport part",rus:"Добавляем поддерживающие порталы и телепортируем эту часть"),description:Some((eng:"At the end of this animation portall will become continuous.\n\nTry watch this animation with disabled «Teleport light» option. Green color represent teleported part.",rus:"Под конец этой анимации портал станет непрерывным.\n\nПопробуйте прокрутить эту анимацию с выключенной опцией «Teleport light». Зелёный цвет означает телепортированный портал.")),uniforms:({((42)):FromDev,((10)):FromDev,((8)):Changed(Some(((24)))),((6)):Changed(Some(((23)))),((40)):FromDev,((7)):FromDev,((22)):ProvidedToUser,((1)):FromDev,((12)):FromDev,((16)):Changed(Some(((37)))),((18)):Changed(Some(((25)))),((41)):FromDev,((9)):Changed(Some(((26)))),((17)):Changed(Some(((27)))),((11)):FromDev,((2)):FromDev,((0)):FromDev}),matrices:({((14)):FromDev,((17)):FromDev,((15)):FromDev,((16)):FromDev,((18)):FromDev,((0)):FromDev}),original_cam_button:false,set_cam:None,cams:{}),"teleport"),(2):Named((name:(eng:"Explore offset",rus:"Исследование смещения"),description:Some((eng:"Portal become continuous only for offsets 0 (regular monoportal) and 0.5 of its own height.",rus:"Портал получается непрерывным только для смещения 0 (обычный монопортал) и 0.5 от высоты портала.")),uniforms:({((11)):FromDev,((7)):FromDev,((2)):FromDev,((42)):Changed(Some(((43)))),((40)):ProvidedToUser,((0)):FromDev,((22)):FromDev,((6)):ChangedAndToUser(Some(((28)))),((16)):Changed(Some(((36)))),((10)):FromDev,((41)):ProvidedToUser,((18)):FromDev,((1)):FromDev,((17)):Changed(Some(((29)))),((12)):FromDev,((9)):FromDev,((8)):FromDev}),matrices:({((14)):FromDev,((16)):FromDev,((18)):FromDev,((17)):FromDev,((0)):FromDev,((15)):FromDev}),original_cam_button:false,set_cam:None,cams:{}),"explore offset"),(3):Named((name:(eng:"Make portal bigger",rus:"Делаем портал больше"),description:Some((eng:"You can see that with big portal floor and ceiling meets each other precisely in twe between of room height.",rus:"Можно видеть что с большим порталом пол и потолок встречаются ровно посередине высоты комнаты.")),uniforms:({((42)):FromDev,((8)):FromDev,((7)):FromDev,((0)):FromDev,((10)):Changed(Some(((32)))),((22)):ProvidedToUser,((9)):FromDev,((40)):FromDev,((11)):Changed(Some(((33)))),((1)):FromDev,((6)):FromDev,((2)):FromDev,((12)):FromDev,((16)):Changed(Some(((38)))),((41)):FromDev,((17)):Changed(Some(((34)))),((18)):FromDev}),matrices:({((15)):FromDev,((18)):FromDev,((0)):FromDev,((17)):FromDev,((16)):FromDev,((14)):FromDev}),original_cam_button:false,set_cam:None,cams:{}),"raise")},storage_order:[(0),(1),(2),(3)]),current_stage:Some(((3))),dev_stage:(uniforms:({((7)):Float((min:None,max:None,value:0.13)),((11)):Float((min:None,max:None,value:1)),((12)):Bool(true),((16)):Float((min:Some(0),max:None,value:0)),((22)):Progress(0),((41)):Float((min:Some(-0.75),max:Some(0.75),value:-0.17000000000000004)),((6)):Float((min:Some(0),max:Some(0.5),value:0.5)),((1)):Float((min:Some(0),max:None,value:4)),((17)):Progress(0),((9)):Float((min:Some(0),max:None,value:0)),((2)):Float((min:Some(0),max:None,value:4)),((18)):Progress(1),((0)):Float((min:Some(0),max:None,value:4)),((8)):Progress(0),((40)):Float((min:Some(-0.75),max:Some(0.75),value:-0.33)),((10)):Float((min:None,max:None,value:1)),((42)):Bool(false)}),matrices:({((16)):Parametrized(offset:(x:No(0),y:Yes(Some(((15)))),z:No(0)),rotate:(x:No(4.71238898038469),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1)),((18)):Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((0)):Simple(offset:(0,0,0),scale:1,rotate:(0,0,0),mirror:(false,false,false)),((14)):Teleport(first_portal:Some(((16))),second_portal:Some(((15))),what:Some(((17)))),((15)):Parametrized(offset:(x:No(0),y:Yes(Some(((14)))),z:No(0)),rotate:(x:No(4.71238898038469),y:No(0),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1)),((17)):Parametrized(offset:(x:No(0),y:Yes(Some(((13)))),z:No(0)),rotate:(x:No(0),y:No(3.141592653589793),z:No(0)),mirror:(x:No(0),y:No(0),z:No(0)),scale:No(1))})))